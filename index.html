<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>VietQR Generator</title>
<style>
body { font-family: Arial; }
input, select { padding: 6px; margin: 3px; }
button { padding: 8px 15px; cursor: pointer; }
img { border: 1px solid #ccc; margin-top: 10px; }
</style>
</head>

<body>

<h2>VietQR Generator</h2>

<label>Số tiền:</label>
<input id="money" placeholder="VD: 300000">

<label><input type="checkbox" id="useMoney" checked> Gắn số tiền</label>
<br>

<label>Nội dung:</label>
<input id="info" value="NAP NET">
<label><input type="checkbox" id="useInfo" checked> Gắn nội dung</label>
<br>

<label>Tên tài khoản:</label>
<input id="name" value="HUYNH CHANH THUAT">
<label><input type="checkbox" id="useName" checked> Gắn tên</label>
<br>

<label>Kiểu hiển thị:</label>
<select id="style">
<option value="print">PRINT (to, có thông tin)</option>
<option value="compact">COMPACT (nhỏ)</option>
</select>

<br><br>
<button onclick="gen()">Tạo QR</button>
<button onclick="downloadImg()">Tải ảnh</button>

<br>
<img id="qr" width="450">

<script>
let bank = "970403";
let account = "054601092000";

function gen() {
    let money = document.getElementById("money").value.trim();
    money = money.replace(/\./g,"").replace(/,/g,"");

    let info = document.getElementById("info").value;
    let name = document.getElementById("name").value;

    let useMoney = document.getElementById("useMoney").checked;
    let useInfo  = document.getElementById("useInfo").checked;
    let useName  = document.getElementById("useName").checked;

    let style = document.getElementById("style").value;

    let url = `https://img.vietqr.io/image/${bank}-${account}-${style}.png?`;

    if(useMoney && money !== "")
        url += `amount=${money}&`;

    if(useInfo && info !== "")
        url += `addInfo=${encodeURIComponent(info)}&`;

    if(useName && name !== "")
        url += `accountName=${encodeURIComponent(name)}&`;

    document.getElementById("qr").src = url;
    currentUrl = url;
}

let currentUrl = "";

function downloadImg() {
    if (!currentUrl) return alert("Chưa tạo QR");
    const a = document.createElement("a");
    a.href = currentUrl;
    a.download = "vietqr.png";
    a.click();
}
</script>

</body>
</html>
